<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gelada Express üç∫</title>

<style>
:root{
    --primary:#f7c600;
    --success:#25d366;
    --danger:#ff4444;
}
*{box-sizing:border-box;font-family:'Segoe UI',Arial;}
body{
    margin:0;
    background:radial-gradient(circle at top,#1a1a1a,#000);
    color:#fff;
    padding-bottom:140px;
}
header{
    background:linear-gradient(135deg,#f7c600,#ffb300);
    color:#000;
    padding:22px;
    text-align:center;
    font-size:26px;
    font-weight:900;
}
.subheader{
    background:#0f0f0f;
    text-align:center;
    padding:10px;
    font-size:14px;
    color:var(--primary);
}
.container{padding:16px;max-width:650px;margin:auto;}
.section-title{
    margin:28px 0 14px;
    font-size:20px;
    font-weight:bold;
    color:var(--primary);
}
.card{
    background:#1b1b1b;
    border-radius:16px;
    padding:14px;
    margin-bottom:12px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}
.qty{
    width:70px;
    padding:8px;
    border-radius:10px;
    border:none;
    background:#000;
    color:#fff;
    text-align:center;
}
input,select{
    width:100%;
    padding:14px;
    border-radius:14px;
    border:none;
    margin-top:10px;
    background:#1a1a1a;
    color:#fff;
}
button{
    width:100%;
    padding:18px;
    background:linear-gradient(135deg,#25d366,#1ebe5d);
    border:none;
    color:#000;
    font-size:18px;
    font-weight:900;
    border-radius:18px;
    margin-top:20px;
}
.total{
    font-size:26px;
    text-align:center;
    color:var(--primary);
    margin-top:20px;
}
.whatsapp{
    position:fixed;
    bottom:20px;
    right:20px;
    background:#25d366;
    width:70px;
    height:70px;
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:34px;
    text-decoration:none;
    color:#000;
}
#painelAdmin{
    display:none;
    background:#111;
    border-radius:18px;
    padding:16px;
    margin-top:25px;
}
.estoqueItem{
    display:flex;
    gap:6px;
    margin-bottom:8px;
    flex-wrap:wrap;
}
.estoqueItem input{
    width:80px;
    padding:6px;
    border-radius:8px;
}
.estoqueItem button{
    background:var(--danger);
    color:#fff;
    border:none;
    padding:6px 10px;
    border-radius:8px;
}
.relatorio{
    background:#1c1c1c;
    padding:10px;
    border-radius:10px;
    margin-top:10px;
}
</style>
</head>

<body>

<header>üç∫ Gelada Express</header>
<div class="subheader">Pedidos das 13:00 √†s 00:00 ‚Ä¢ Entrega pr√≥pria</div>

<div class="container">

<div class="section-title">üç∫ Produtos</div>
<div id="produtosContainer"></div>

<div class="section-title">üìç Entrega</div>
<select id="bairroEntrega" onchange="calcularTotal()">
<option value="5">Centro - R$5</option>
<option value="7">Bairro A - R$7</option>
<option value="10">Bairro B - R$10</option>
<option value="12">Bairro C - R$12</option>
</select>

<button onclick="pegarLocalizacao()">üìç Usar minha localiza√ß√£o</button>

<div class="section-title">üè† Endere√ßo</div>
<input id="nomeCliente" placeholder="Nome">
<input id="rua" placeholder="Rua">
<input id="numero" placeholder="N√∫mero">
<input id="bairroCliente" placeholder="Bairro">
<input id="complemento" placeholder="Complemento">
<input id="referencia" placeholder="Refer√™ncia">

<div class="total" id="total">Total: R$ 0,00</div>

<button onclick="finalizarPedido()">Finalizar Pedido no WhatsApp</button>
<button onclick="mostrarPainelAdmin()">üîë Painel Administrativo</button>

<div id="painelAdmin">

<h3>üì¶ Estoque (editar / remover)</h3>
<div id="estoqueAdmin"></div>

<h3>‚ûï Adicionar Produto</h3>
<input id="novoNome" placeholder="Nome do produto">
<input id="novoQtd" type="number" placeholder="Quantidade">
<input id="novoPreco" type="number" placeholder="Pre√ßo">
<button onclick="adicionarProduto()">Adicionar Produto</button>

<h3>üìä Relat√≥rio de Vendas</h3>
<div id="relatorioVendas"></div>

</div>
</div>

<a class="whatsapp" href="https://wa.me/5598981102515" target="_blank">üí¨</a>

<script>
const VALOR_MINIMO = 20;

let estoque = JSON.parse(localStorage.getItem("estoque")) || {
    Skol:{qtd:50,preco:6.5},
    Brahma:{qtd:50,preco:6.5},
    Heineken:{qtd:30,preco:11},
    Coca:{qtd:40,preco:6}
};

let vendas = JSON.parse(localStorage.getItem("vendas")) || [];
let localizacao="";

/* PRODUTOS */
function renderizarProdutos(){
    produtosContainer.innerHTML="";
    for(let k in estoque){
        let d=document.createElement("div");
        d.className="card";
        d.innerHTML=`${k} (R$ ${estoque[k].preco.toFixed(2)})
        <input type="number" id="${k}" class="qty" min="0" value="0" oninput="calcularTotal()">`;
        produtosContainer.appendChild(d);
    }
}
renderizarProdutos();

/* TOTAL */
function calcularTotal(){
    let total=0;
    for(let k in estoque){
        let q=parseInt(document.getElementById(k)?.value)||0;
        total+=q*estoque[k].preco;
    }
    total+=parseFloat(bairroEntrega.value);
    totalDiv.innerText="Total: R$ "+total.toFixed(2);
}
const totalDiv=document.getElementById("total");

/* GEO */
function pegarLocalizacao(){
    navigator.geolocation.getCurrentPosition(p=>{
        localizacao=`https://maps.google.com/?q=${p.coords.latitude},${p.coords.longitude}`;
        alert("Localiza√ß√£o capturada!");
    });
}

/* FINALIZAR */
function finalizarPedido(){
    let total=parseFloat(totalDiv.innerText.replace("Total: R$",""));
    if(total<VALOR_MINIMO){
        alert(`Pedido m√≠nimo R$ ${VALOR_MINIMO}`);
        return;
    }

    let pedido="üç∫ *Pedido Gelada Express*%0A";

    for(let k in estoque){
        let q=parseInt(document.getElementById(k).value)||0;
        if(q>0){
            pedido+=`‚Ä¢ ${k}: ${q}%0A`;
            estoque[k].qtd -= q;
        }
    }

    pedido+=`%0A${totalDiv.innerText}`;
    pedido+=`%0Aüè† ${rua.value}, ${numero.value} - ${bairroCliente.value}`;
    if(localizacao) pedido+=`%0Aüìç ${localizacao}`;

    vendas.push({data:new Date().toISOString(),total});

    localStorage.setItem("estoque",JSON.stringify(estoque));
    localStorage.setItem("vendas",JSON.stringify(vendas));

    renderizarProdutos();
    atualizarPainelAdmin();
    atualizarRelatorio();

    window.open(`https://wa.me/5598999999999?text=${pedido}`);
}

/* ADMIN */
function mostrarPainelAdmin(){
    if(prompt("Senha:")==="ADMIN123"){
        painelAdmin.style.display="block";
        atualizarPainelAdmin();
        atualizarRelatorio();
    }
}

function atualizarPainelAdmin(){
    estoqueAdmin.innerHTML="";
    for(let k in estoque){
        let p=estoque[k];
        let d=document.createElement("div");
        d.className="estoqueItem";
        d.innerHTML=`
        <input value="${k}" onchange="editarNome('${k}',this.value)">
        <input type="number" value="${p.qtd}" onchange="editarProduto('${k}','qtd',this.value)">
        <input type="number" value="${p.preco}" onchange="editarProduto('${k}','preco',this.value)">
        <button onclick="removerProduto('${k}')">üóë</button>`;
        estoqueAdmin.appendChild(d);
    }
}

function editarProduto(k,c,v){
    estoque[k][c]=parseFloat(v)||0;
    salvar();
}
function editarNome(oldKey,newKey){
    if(!newKey||estoque[newKey])return;
    estoque[newKey]=estoque[oldKey];
    delete estoque[oldKey];
    salvar();
}
function adicionarProduto(){
    if(!novoNome.value)return;
    estoque[novoNome.value]={qtd:+novoQtd.value||0,preco:+novoPreco.value||0};
    novoNome.value=novoQtd.value=novoPreco.value="";
    salvar();
}
function removerProduto(k){
    delete estoque[k];
    salvar();
}
function salvar(){
    localStorage.setItem("estoque",JSON.stringify(estoque));
    renderizarProdutos();
    atualizarPainelAdmin();
}

/* RELAT√ìRIO */
function atualizarRelatorio(){
    let hoje=0,semana=0,mes=0;
    let agora=new Date();
    vendas.forEach(v=>{
        let d=new Date(v.data);
        let diff=(agora-d)/(1000*60*60*24);
        if(diff<1)hoje+=v.total;
        if(diff<7)semana+=v.total;
        if(d.getMonth()===agora.getMonth())mes+=v.total;
    });
    relatorioVendas.innerHTML=`
    <div class="relatorio">Hoje: R$ ${hoje.toFixed(2)}</div>
    <div class="relatorio">Semana: R$ ${semana.toFixed(2)}</div>
    <div class="relatorio">M√™s: R$ ${mes.toFixed(2)}</div>`;
}
</script>

</body>
</html>
